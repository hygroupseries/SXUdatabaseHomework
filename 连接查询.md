1.查询所有选课学生的学号、姓名、课程名称及成绩。

```
SELECT student.sno, student.sname, student.smajor, sc.grade
FROM student , sc
WHERE student.sno = sc.sno;


```

2.查询每门课程的课程号、课程名及选课人数。

```
SELECT c.cno, c.cname, COUNT(*) as num
FROM sc s , course c
where s.cno = c.cno
GROUP BY c.cno;
```

3.查询每个学生的学号、姓名及选课门数。

```
SELECT s.sno, s.sname, count(*) as num
FROM student s , sc
WHERE s.sno = sc.sno
GROUP BY sc.sno;
```

4.查询姓张的学生所选修的课程号、课程名称.

```
SELECT c.cno , c.cname
FROM student s, course c, sc
WHERE sname LIKE '张%' AND s.sno = sc.sno AND sc.cno = c.cno;
```

5.统计每个同学选修及格的课程的平均分，列出其学号、姓名及平均分.

```
SELECT s.sno, s.sname, AVG(sc.grade) as AVG_grade
FROM student s , sc
WHERE sc.grade is not NULL and sc.grade >= 60 and s.sno = sc.sno
group by sc.sno;
```

6.查询选修了课程C1和C2的学生的学号和其各自成绩

```
SELECT sc1.sno sno, sc1.grade C1_grade, sc2.grade C2_grade
FROM sc sc1 ,sc sc2
WHERE sc1.sno = sc2.sno and sc1.cno = '218002' and sc2.cno = '218004';
```

7.查询选修了C1和C2课程，并且成绩均大于85分的同学的学号、课程号以及成绩

```
SELECT sc1.sno sno, sc1.cno cno, sc1.grade C1_grade, sc2.grade C2_grade
FROM sc sc1 ,sc sc2
WHERE sc1.sno = sc2.sno and sc1.cno = '218002' and sc1.grade > 85 and sc2.cno = '218004' and sc2.grade > 85;
```

8.查询每一门课程的间接先修课程号

```
SELECT c.cno, c.cname, cp.cno as '间接先修课程号'
FROM course c left join course cp on c.cpno = cp.cno
GROUP BY c.cno, c.cname;
```

9.查询跟20201031号学生同学院的学生的学号与姓名

```
SELECT s1.sno, s1.sname
FROM student s1, student s2
WHERE s1.smajor = s2.smajor and s2.sno = 202102811420;
```

10.查询选修了数据库这门课的学生的学号及姓名

```
SELECT s.sno, s.sname
FROM student s, sc, course c
WHERE s.sno = sc.sno and sc.cno = c.cno and c.cname = '数据库';
```

